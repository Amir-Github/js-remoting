<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
	<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
	<title>Seam Remoting - Model Example</title>
</head>

<body>

  <h1>Seam Remoting - Model Example</h1>
  
  <script type="text/javascript" src="seam/resource/remoting/resource/remote.js"></script>
  
  <script type="text/javascript">    
    //<![CDATA[
    
    Seam.debug = true;
    
    var model = null;
  
    function loadPerson() {
      var personId = document.getElementById("personId").value;
      
      model = new Seam.Model();

      var callback = function(model) { var p = model.getValue("person"); alert(p.getFirstName() + " " + p.getLastName()); };
              
      model.addBeanProperty("person", "org.jboss.seam.remoting.examples.model.PersonAction", "person");
      model.fetch(new Seam.Action()
        .setBeanType("org.jboss.seam.remoting.examples.model.PersonAction")
        .setMethod("editPerson")
        .addParam(personId), callback);
    }
    
    function expandModel() {
      var callback = function(model) { alert("Got addresses: " + model.getValue("person").getAddresses().length); };
      
      model.expand(model.getValue("person"), "addresses", callback); 
    }
    
    function modifyPerson() {
      model.getValue("person").setFirstName("bob");
    }
    
    function applyUpdates() {
      var callback = function(model) { alert("updates applied"); };
      
      model.applyUpdates(new Seam.Action()
        .setBeanType("org.jboss.seam.remoting.examples.model.PersonAction")
        .setMethod("savePerson"),
        callback);
    }

    // ]]>
  </script> 
  
  <label for="personId">Person ID</label><input type="text" id="personId" value="1"/>
  
  <button onclick="javascript:loadPerson()">Load person</button> 
  <button onclick="javascript:expandModel()">expand model</button>
  <button onclick="javascript:modifyPerson()">Modify person</button>
  <button onclick="javascript:applyUpdates()">Apply updates</button>


</body>
</html>

